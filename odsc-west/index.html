<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>reveal.js</title>

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/simple.css">
    <link rel="stylesheet" href="css/custom.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">

        <!-- Title -->
        <section>
          <h1 class="my-title num-title" id="title-6-viz">5</h1>
          <h1 id="cover-title" class="my-title">Visualizations</h1>
          <p id="help-you">that will help you build better predictive models</p>
          <div id="odsc-pic" class="sl-block" data-block-type="image" data-block-id="bcd0e8cb31b72285ea9e8b019c068ad5" style="min-width: 30px; min-height: 30px; width: 257.143px; height: 63px; left: 352px; top: 567px;">
            <div class="sl-block-content" style="z-index: 14;"><img data-natural-width="600" data-natural-height="147" data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/511359/images/2629977/ODSC_logo_blue_no_gradient_cs6.png"></div>
          </div>
        </section>

        <!-- Intro -->
        <section>
          <section>
            <p class="my-header">dataviz@datarobot</p>
            <img src="datarobot.png"/>
          </section>
          <section>
            <p class="my-header">Sexy</p>
            <div id="ugly-plot" class="sl-block" data-block-type="image" data-block-id="763bdb04196480a23b3ee5d5a4308780" style="min-width: 30px; min-height: 30px; width: 690.9px; height: 470px; left: 143px; top: 149px;"><div class="sl-block-content" style="z-index: 12;"><img data-natural-width="1323" data-natural-height="900" style="" data-src="sexy.png"></div></div>
          </section>
          <section>
            <p class="my-header">Ugly</p>
            <div id="ugly-plot" class="sl-block" data-block-type="image" data-block-id="763bdb04196480a23b3ee5d5a4308780" style="min-width: 30px; min-height: 30px; width: 690.9px; height: 470px; left: 143px; top: 149px;"><div class="sl-block-content" style="z-index: 12;"><img data-natural-width="1323" data-natural-height="900" style="" data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/511359/images/2626905/Screen_Shot_2016-05-17_at_9.53.40_PM.png"></div></div>
          </section>
        </section>

        <!-- Summary -->
        <section>
          <!-- Old paradigm -->
          <section>
            <p class="my-header">Old modeling paradigm</p>
            <ul>
              <li>Labor-intensive feature engineering</li>
              <li>Train models</li>
              <li>Validate and compare models</li>
              <li>Interpret results</li>
            </ul>
            <aside class="notes">
              Today I’m going to be talking about how visualizations can help your predictive modeling. And central to this is a rethinking of how we go about the modeling process. The so-called “old” way of doing things is that we spend a lot of time and energy on feature engineering, then once we have that all figured out we’ll build some models, validate them, and if they’re any good use them to make predictions. At DataRobot, and what I’ll be talking about here today, we really emphasize starting the model building process as early as possible, and using visualizations, to drive feature engineering….so the modeling pipeline becomes more of this cyclic, iterative process.
            </aside>
          </section>
          <!-- New paradigm -->
          <section>
            <p class="my-header">New modeling paradigm</p>
            <ul>
              <li>Some feature engineering</li>
              <li><strong>Start training right away</strong></li>
              <li>Validate and compare models</li>
              <li>Use models and <strong>visualizations</strong> to prioritize features to investigate</li>
              <li>Cycle back</li>
            </ul>
          </section>
          <section>
            <p class="my-header">Disclaimer</p>
          </section>
        </section>

        <!-- Example problem -->
        <section>
          <section>
            <p class="my-header">A prediction problem</p>
            <p class="my-header-2"><strong>Predicting election meme popularity</strong></p>
          </section>
          <section id="meme-economy-section">
            <img class="meme-economy" src="memes/meme-economy1.png">
            <img class="meme-economy" src="memes/meme-economy2.png">
            <img class="meme-economy" src="memes/meme-economy3.png">
            <img class="meme-economy" src="memes/meme-economy4.png">
            <img class="meme-economy" src="memes/meme-economy5.png">
            <img class="meme-economy" src="memes/meme-economy6.png">
          </section>
          <section>
            <p class="my-header">What is a meme?</p>
            <ul>
              <li>"An idea, behavior, or style that spreads from person to person within a culture"</li>
              <li>Typically a reusable picture captioned in culturally relevant ways</li>
              <li>Primary mode of communication among millennials</li>
              <li>Complicit in creating a gross monoculture of human expression</li>
            </ul>
            <br>
            <div class="row">
              <div class="col-md-6"><img id="big-data" src="memes/big-data.png"></div>
              <div class="col-md-6"><img id="break-statement" src="memes/break-statement.png"></div>
            </div>
          </section>
          <section>
            <img id="tom-cruise" src="memes/looks-like-tom.jpg">
          </section>
        </section>

        <!-- Go over data -->
        <section>
          <section>
            <p class="my-header">The Data</p>
            <p>14.3k Donald Trump and Hillary Clinton memes</p>
            <ul>
              <li>Likes - not normalized :(</li>
              <li>Author (AdviceAnimals, No Chill, dankmemes, dankchristianmemes)</li>
              <li>Network (Facebook, Imgur, Instagram, Twitter)</li>
              <li>Link to post</li>
              <li>Date of authorship</li>
              <li>Extracted meme caption (text)</li>
              <li>Derived features (Hillary topics, Trump topics, seasonality features)</li>
            </ul>
          </section>
        </section>

        <!-- 1-3 histogram, distribution vs. histogram, predicted vs. actual -->
        <section>
          <section>
            <h1 class="my-title num-title" id="title-1-hist">1</h1>
          </section>
          <section>
            <h1 class="my-title">Data exploration</h1>
          </section>
          <section class="scrollable chart">
            <h4 id="like-histogram-title">Distribution of likes</h4>
            <div id="like-histogram"></div>
          </section>
          <section class="chart">
            <h4>Distribution of likes across time</h4>
            <div id="target-histogram"></div>
          </section>
          <section>
            <p class="my-header">Topics</p>
          </section>
          <section>
            <img id="melania-michelle" src="memes/melania-michelle.png">
          </section>
          <section id="topic-section">
            <div class="row">
            <!-- TRUMP -->
              <div class="col-md-2">
                <p class="trump-topic">Topic 1</p>
                <ul>
                     <li>donald</li>
                     <li>just</li>
                     <li>room</li>
                     <li>melania</li>
                     <li>locker</li>
                     <li>2018</li>
                     <li>talk</li>
                </ul>
              </div>
              <div class="col-md-2">
                <p class="trump-topic">Topic 2</p>
                <ul>
                     <li>donald</li>
                     <li>puppet</li>
                     <li>sent</li>
                     <li>reddit</li>
                     <li>deport</li>
                     <li>jail</li>
                     <li>america</li>
                </ul>
              </div>
              <div class="col-md-2">
                <p class="trump-topic">Topic 3</p>
                <ul>
                     <li>hillary</li>
                     <li>clinton</li>
                     <li>donald</li>
                     <li>news</li>
                     <li>debate</li>
                     <li>live</li>
                     <li>cnn</li>
                </ul>
              </div>
              <div class="col-md-2">
                <p class="trump-topic">Topic 4</p>
                <ul>
                     <li>trump</li>
                     <li>johnson</li>
                     <li>vote</li>
                     <li>jill</li>
                     <li>donald</li>
                     <li>stein</li>
                     <li>george</li>
                     <li>bush</li>
                     <li>taxes</li>
                </ul>
              </div>
              <div class="col-md-2">
                <p class="trump-topic">Topic 5</p>
                <ul>
                     <li>ago</li>
                     <li>save</li>
                     <li>hours</li>
                     <li>points</li>
                     <li>give</li>
                     <li>report</li>
                     <li>gold</li>
                     <li>comments</li>
                     <li>source</li>
                     <li>permalink</li>
                </ul>
              </div>
              <div class="col-md-2">
                <p class="trump-topic">Topic 6</p>
                <ul>
                     <li>like</li>
                     <li>white</li>
                     <li>just</li>
                     <li>frog</li>
                     <li>cuck</li>
                     <li>new</li>
                     <li>meme</li>
                     <li>somebody</li>
                     <li>pepe</li>
                </ul>
              </div>
            </div>
            <!-- HILLARY -->
            <div class="row">
              <div class="col-md-2">
                <p class="hillary-topic">Topic 1</p>
                <ul>
                     <li>hillary</li>
                     <li>clinton</li>
                     <li>debate</li>
                     <li>live</li>
                     <li>news</li>
                     <li>msnbc</li>
                     <li>cnn</li>
                     <li>breaking</li>
                     <li>trump</li>
                </ul>
              </div>
              <div class="col-md-2">
                <p class="hillary-topic">Topic 2</p>
                <ul>
                     <li>hillary</li>
                     <li>clinton</li>
                     <li>news</li>
                     <li>information</li>
                     <li>bullshit</li>
                     <li>lead</li>
                     <li>arrest</li>
                     <li>wikileaks</li>
                </ul>
              </div>
              <div class="col-md-2">
                <p class="hillary-topic">Topic 3</p>
                <ul>
                     <li>hillary</li>
                     <li>trump</li>
                     <li>clinton</li>
                     <li>release</li>
                     <li>emails</li>
                     <li>campaign</li>
                     <li>called</li>
                     <li>deleted</li>
                </ul>
              </div>
              <div class="col-md-2">
                <p class="hillary-topic">Topic 4</p>
                <ul>
                     <li>trump</li>
                     <li>hillary</li>
                     <li>like</li>
                     <li>clinton</li>
                     <li>us</li>
                     <li>go</li>
                     <li>parents</li>
                     <li>fighting</li>
                </ul>
              </div>
              <div class="col-md-2">
                <p class="hillary-topic">Topic 5</p>
                <ul>
                     <li>like</li>
                     <li>reply</li>
                     <li>ago</li>
                     <li>save</li>
                     <li>people</li>
                     <li>hours</li>
                     <li>share</li>
                     <li>can</li>
                </ul>
              </div>
              <div class="col-md-2">
                <p class="hillary-topic">Topic 6</p>
                <ul>
                     <li>hillary</li>
                     <li>clinton</li>
                     <li>vote</li>
                     <li>matter</li>
                     <li>bernie</li>
                     <li>issues</li>
                     <li>compare</li>
                     <li>people</li>
                </ul>
              </div>
            </div>
          </section>
          <section>
            <p class="my-header">Topic 9</p>
          </section>
          <section class="chart">
            <h4>Topic 9</h4>
            <div id="topic-word-distribution"></div>
          </section>
          <section class="chart">
            <h4>One meme's topic distribution</h4>
            <img id="wall-of-fame" src="memes/knock-walls.png">
            <img id="trump-face" src="memes/trump-face.png">
            <img id="hillary-face" src="memes/hillary-face.png">
            <div id="meme-topic-distribution"></div>
          </section>
          <section class="chart">
            <h4>Topic 4</h4>
            <div id="overcomb">
              <img src="memes/overcomb.png">
            </div>
            <div id="topic-word-distribution-4"></div>
          </section>
           <section>
            <h1 class="my-title num-title" id="title-2-hist">2</h1>
          </section>
          <section>
            <h1 class="my-title">Predicted vs. Actual</h1>
          </section>
          <section class="chart">
            <h4>Distribution of likes across topic 4</h4>
            <div id="topic-histogram"></div>
            <div id="topics-section">
            </div>
          </section>
          <section>
            <img src="memes/bernie-sanders-dank-meme-stash.png">
          </section>
          <section>
            <p class="my-header">Buy this model because:</p>
            <ul>
              <li>The Gini Norm is 0.933!!!!</li>
              <li>A visual check showed the model performing well across variables Bernie is familiar with.</li>
            </ul>
          </section>
          <section>
            <img id="we-want-memes" src="memes/we-want-memes.jpg">
          </section>
          <section>
            <p class="my-header">Recap</p>
            <ul>
              <li>Data exploration</li>
              <li>Detecting outliers</li>
              <li>Underlayed: target, predicted vs. actual</li>
              <li>
                Provides context for other visualizations
                <ul>
                  <li>Target vs. distribution</li>
                  <li>Predicted vs. actual</li>
                </ul>
              </li>
              <li>Helps instill trust in user</li>
            </ul>
          </section>
        </section>

        <!-- MODEL EVALUATION: Lift chart -->
        <section>
          <section>
            <h1 class="my-title num-title" id="title-4-lift">3</h1>
          </section>
          <section>
            <h1 class="my-title" id="lift-title">Lift chart</h1>
            <p>Measures overall model performance.</p>
          </section>
          <section class="chart">
            <h4>Lift (Blender model)</h4>
            <div id="lift"></div>
          </section>
          <section>
            <p class="my-header">Lift chart: recap</p>
            <ul>
              <li>Look for fit between actual and predicted</li>
              <li>Look for monotonicity of actual</li>
              <li>Look for lift</li>
              <li>Add quantiles for confidence interval estimate</li>
            </ul>
          </section>
        </section>

        <!-- FEATURE SELECTION: Partial dependence -->
        <section>
          <section>
            <h1 class="my-title num-title" id="title-5-pd">4</h1>
          </section>
          <section>
            <h1 class="my-title" id="pd-title">Partial dependence</h1>
            <p>Plots the <i>marginal effect</i> of a predictor on the prediction.</p>
          </section>
          <section id="network-logos">
            <p>Network</p>
            <img class="logo" src="memes/fb-logo.png">
            <img class="logo" src="memes/imgur-logo.png">
            <img class="logo" src="memes/instagram-logo.png">
            <img class="logo" src="memes/twitter-logo.png">
          </section>
          <section>
            <p>1. Fix network = Instagram</p>
          </section>
          <section class="chart">
            <h4>Validation data: Blender Model</h4>
            <div id="pd-matrix"></div>
          </section>
          <section>
            <p>2. Take average prediction from fixed matrix</p>
            <p class="explanation">PD(network=instagram) = avg(F(network=instagram, Xc))</p>
          </section>
          <section class="chart">
            <h4>Network</h4>
            <div id="pd"></div>
          </section>
          <section>
            <p class="my-header">Partial dependence: recap</p>
            <ul>
              <li>Shows relationship between predictor and prediction </li>
              <li>Calculates marginal effect of a predictor by fixing it for each of its values</li>
              <li>Does not take into account correlation with other variables</li>
            </ul>
          </section>
        </section>

        <!-- UNDERSTANDING: Variable importances -->
        <section>
          <section>
            <h1 class="my-title num-title" id="title-6-varimp">5</h1>
          </section>
          <section>
            <h1 class="my-title" id="varimp-title">Variable importance</h1>
            <p>Rank-orders variables by their influence on the target.</p>
          </section>
          <section>
            <p>Example: calculate permutation importance for <strong>caption</strong></p>
          </section>
          <section>
            <p>1. Shuffle caption column in validation data.</p>
          </section>
          <section class="chart">
            <h4>Validation data: Blender model</h4>
            <div id="var-imp1"></div>
          </section>
          <section>
            <p>2. Predict on shuffled validation data.</p>
          </section>
         <!--  <section class="chart">
            <h4>Prediction distribution</h4>
            <div id="var-imp2"></div>
          </section> -->
          <section>
            <p>3. Calculate importances with new scores.</p>
            <p class="explanation">Importance(caption) = |Score(full_data) - Score(shuffled_data)|</p>
          </section>
          <section class="chart">
            <h4>Importances</h4>
            <div id="var-imp3"></div>
          </section>
          <section>
            <p class="my-header">Variable importance: recap</p>
            <ul>
              <li>Common method is permutation importance</li>
              <li>Provides insight into prediction problem</li>
              <li>
                Gives prioritization of features
                <ul>
                  <li>Improve feature engineering and modeling</li>
                  <li>Reduce data collection costs</li>
                </ul>
              </li>
              <li>Compare variable rankings across models</li>
              <li>Communicate results</li>
            </ul>
          </section>
        </section>

        <!-- Summary -->
        <section>
          <section>
            <h1 class="my-title">Key takeaways</h1>
          </section>
          <section>
            <p class="my-header">How to create a successful meme?</p>
            <p>Already have successful memes</p>
          </section>
          <section>
            <ul>
              <li>Histograms provide context</li>
              <li>Lift chart shows overall model performance</li>
              <li>Partial dependence shows marginal effect of predictor on predicted outcome</li>
              <li>Predicted vs. actual shows relationship between predictor and predicted outcome, taking into account correlations</li>
              <li>Variable importances provide a prioritization of features</li>
              <li>Start modeling early!</li>
              <li>Interactivity is exploratory, engaging, and fun</li>
            </ul>
          </section>
        </section>

        <!-- Thank you -->
        <section>
          <p>Thank you!</p>
          <img id="please-clap" src="memes/please-clap.png">
        </section>
      </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script src="js/jquery.min.js"></script>
    <script src="js/d3.min.js"></script>

    <script src="js/data.js"></script>
    <script src="js/data_with_target.js"></script>
    <script src="js/mom_diff_data.js"></script>
    <script src="js/features.js"></script>
    <script src="js/most_imp_features.js"></script>
    <script src="js/importance_data.js"></script>

    <script src="js/charts.js"></script>
    <script src="js/lift.js"></script>
    <script src="js/var-imp.js"></script>
    <script src="js/partial_dependence.js"></script>

    <script>
      var fnMap = {};

      // More info https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        history: true,

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
          { src: 'plugin/markdown/marked.js' },
          { src: 'plugin/markdown/markdown.js' },
          { src: 'plugin/notes/notes.js', async: true },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
        ]
      });

      Reveal.addEventListener('ready', function(event) {
        console.log('ready:', event.currentSlide, event.indexh, event.indexv);
      });

      Reveal.addEventListener('slidechanged', function(event) {
         if (event.indexh in fnMap && event.indexv > 0) fnMap[event.indexh]();

         // Histogram
         if (event.indexh === 5) {
            if (event.indexv === 2) likeHistogram();
            else if (event.indexv === 3) likeOverTime();
            else if (event.indexv === 8) topic9();
            else if (event.indexv === 9) memeTopicDistribution();
            else if (event.indexv === 10) topic4();
            else if (event.indexv === 13) likesOverTopic4();
         }

         // Lift
         if (event.indexh === 6 && event.indexv === 2) {
            lift();
         }

         // Partial dependence
         if (event.indexh === 7) {
            if (event.indexv === 4) pdMatrix();
            if (event.indexv === 6) partialDependence();
         }

         // 1000 variables
         // if (event.indexh === 8) {
         //    $('#tons-of-variables').html('');
         //    var n = 0;
         //    var svg = d3.select('#tons-of-variables').append('svg').attr('height', 500).attr('width', 1000);
         //    var fdata = d3.range(5000);
         //    var text = svg.append('text')
         //      .attr('x', 280)
         //      .attr('y', 250)
         //      .attr('font-size', '200px')
         //      .text('20');
         //    svg.selectAll('.f-data')
         //      .data(fdata)
         //      .enter()
         //      .append('rect')
         //      .attr('x', 0)
         //      .attr('y', 0)
         //      .attr('height', 0)
         //      .attr('width', 0)
         //      .transition()
         //      .duration(2000)
         //      .delay((d, i) => (i / 1000) * 2000)
         //      .attr('x', 0)
         //      .each('end', function(d, i) {
         //        n += 1;
         //        text.text(n);
         //      });
         // }

         // Var imp
         if (event.indexh == 8) {
            if (event.indexv === 2) shuffleMatrix();
            // else if (event.indexv === 5) showDistributions();
            else if (event.indexv === 7) showVarImp();
         }
      });

    </script>
  </body>
</html>
